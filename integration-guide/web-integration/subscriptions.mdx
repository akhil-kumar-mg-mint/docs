---
title: "Subscriptions"
description: "Set up and manage UPI subscription mandates using EximPe Partner APIs."
---

<Note>
  UPI subscriptions let you collect recurring payments from customers using Standing Instructions (SI).
  This guide walks through how to create and manage subscriptions using EximPe Partner APIs.
</Note>

<CardGroup cols={4}>
  <Card title="Create Subscription" icon="repeat" href="#step-1-create-subscription">
    Create a subscription order with standing instructions (SI)
  </Card>
  <Card title="Check Mandate Status" icon="clock" href="#step-2-check-mandate-status">
    Verify that the UPI mandate is active before proceeding
  </Card>
  <Card title="Trigger Recurring Payment" icon="credit-card" href="#step-3-trigger-recurring-payment">
    Send pre-debit notification and trigger recurring payment
  </Card>
  <Card title="Server Callback" icon="server" href="#step-4-modify-or-cancel-mandate">
    Receive asynchronous status updates via webhook
  </Card>
</CardGroup>

## Prerequisites

Before you begin, ensure you have:

- **Partner API credentials**: `X-Client-ID` and `X-Client-Secret` to call the Partner APIs.
- **UPI SI enablement**: UPI recurring (SI) enabled and approved by EximPe.
- **Server environment**: Ability to make HTTPS `POST` and `GET` requests from your backend.
- **JSON & HTTP Client**: Familiarity with JSON request bodies and HTTP client libraries.

## Integration Steps

The integration consists of four steps:

1. **Create Subscription**
2. **Check Mandate Status**
3. **Trigger Recurring Payment**
4. **Modify or Cancel Mandate**

## Step 1: Create Subscription

Use the **Create UPI Subscription** API to create a subscription order and standing instruction. You can use either Intent Flow (QR code/payment link) or Collection Flow (requires VPA).

### Intent Flow

Use the **Intent Flow** to create subscriptions without requiring the customer's VPA upfront. The Intent flow allows customers to approve the mandate by scanning a QR code or using a UPI payment link.

#### Sample Request (Intent Flow)

```json
curl -X POST https://api-pacb.eximpe.com/pg/subscriptions/ \
  -H "Content-Type: application/json" \
  -H "X-Client-ID: <your-client-id>" \
  -H "X-Client-Secret: <your-client-secret>" \
  -d '{
    "amount": "1000.00",
    "currency": "INR",
    "buyer_name": "John Doe",
    "buyer_email": "john.doe@example.com",
    "buyer_phone": "9876543210",
    "collection_mode": "s2s",
    "preferred_mop_type": "UPI",
    "preferred_upi_flow_type": "INTENT",
    "reference_id": "ORD-2024-001",
    "return_url": "https://example.com/return",
    "description": "Monthly subscription payment",
    "standing_instruction": {
      "billing_amount": "1000.00",
      "billing_currency": "INR",
      "billing_cycle": "MONTHLY",
      "billing_interval": 1,
      "payment_start_date": "2025-01-01",
      "payment_end_date": "2025-12-31",
      "billing_date": 15,
      "billing_limit": "AFTER",
      "billing_rule": "MAX",
      "remarks": "Monthly subscription"
    }
  }'
```

#### Response (Intent Flow)

```json
{
  "success": true,
  "message": "UPI Subscription created successfully",
  "data": {
    "order_id": "550e8400-e29b-41d4-a716-446655440000",
    "subscription_id": "660e8400-e29b-41d4-a716-446655440001",
    "subscription_type": "UPI_RECURRING",
    "payment_link": "pa=merchant@payu&pn=Merchant%20Name&am=1000.00&cu=INR&tn=Order%20Description&tr=ORD-2024-001",
    "qr_code": {
      "url": "upi://pay?pa=merchant@payu&pn=Merchant%20Name&am=1000.00&cu=INR&tn=Order%20Description&tr=ORD-2024-001",
      "base64": "iVBORw0KGgoAAAANSUhEUgAA..."
    },
    "subscription": {
      "billing_cycle": "MONTHLY",
      "billing_interval": 1,
      "payment_start_date": "2025-01-01",
      "payment_end_date": "2025-12-31",
      "status": "PENDING"
    }
  }
}
```

<Note>
  **Key differences between Collection and Intent flow:**
  
  - **Collection Flow**: Requires customer's VPA upfront. Payment request is sent directly to the customer's UPI app.
  - **Intent Flow**: No VPA required. Customer approves mandate by scanning QR code or using payment link. Returns QR code in base64 format for display.
  
  The Intent flow is ideal when you want to let customers approve mandates without collecting their VPA first.
</Note>

#### Display QR Code

The response includes a base64-encoded QR code that can be displayed directly:

```html
<img src="data:image/png;base64,{data.qr_code.base64}" alt="UPI Payment QR Code" />
```

Alternatively, you can use the `payment_link` to generate a QR code client-side or use the provided `qr_code.url` for UPI app deep linking.

For full request and response schema, see the **Create UPI Subscription (Intent Flow)** endpoint in API Reference.

### Collection Flow

Alternatively, you can use the **Collection Flow** which requires the customer's VPA upfront. Payment request is sent directly to the customer's UPI app.

To start with, the request is raised from the Merchant to EximPe with the required transaction mandatory/optional parameters. This needs to be a server-to-server curl call request.

#### Sample Request (Collection Flow)

```json
curl -X POST https://api-pacb.eximpe.com/partner-api/subscriptions/ \
  -H "Content-Type: application/json" \
  -H "X-Client-ID: <your-client-id>" \
  -H "X-Client-Secret: <your-client-secret>" \
  -d '{
    "amount": "1000.00",
    "currency": "INR",
    "reference_id": "SUB-ORDER-001",
    "preferred_mop_type": "UPI",
    "preferred_collection_mode": "S2S",
    "preferred_upi_flow_type": "COLLECTION",
    "buyer_name": "John Doe",
    "buyer_email": "john@example.com",
    "buyer_phone": "+911234567890",
    "standing_instruction": {
      "billing_amount": "1000.00",
      "billing_currency": "INR",
      "billing_cycle": "MONTHLY",
      "billing_interval": 1,
      "payment_start_date": "2025-01-01",
      "payment_end_date": "2025-12-31",
      "billing_date": 5,
      "billing_limit": "AFTER",
      "billing_rule": "MAX",
      "remarks": "Subscription for plan X",
      "status": "ACTIVE"
    }
  }'
```

#### Response (Collection Flow)

```json
{
  "success": true,
  "message": "UPI Subscription created successfully",
  "data": {
    "order_id": "ORD_xxx",
    "subscription_type": "UPI_RECURRING",
    "payment_link": "upi://pay?...",
    "subscription_id": "SUB_xxx"
  }
}
```

For full request and response schema, see the **Create UPI Subscription** endpoint in API Reference.

## Step 2: Check Mandate Status

After the customer approves the UPI mandate, use the **Get Subscription Mandate Status** API to verify that it is active.

Check the subscription mandate status using the **Get Subscription Mandate Status** API. For more information, refer to **Get Subscription Mandate Status API**.

### Sample Request

```json
curl -X GET "https://api-pacb.eximpe.com/partner-api/subscriptions/SUB_xxx/mandate_status/" \
  -H "X-Client-ID: <your-client-id>" \
  -H "X-Client-Secret: <your-client-secret>"
```

### Response

```json
{
  "success": true,
  "message": "Subscription mandate status fetched successfully",
  "data": {
    "subscription_id": "SUB_xxx",
    "mandate_is_active": true
  }
}
```

Only proceed to debit the customer when `mandate_is_active` is `true`.

## Step 3: Trigger Recurring Payment

### 3.1 Send Pre-Debit Notification

Use the **Pre-Debit Notification** API to inform the customer about an upcoming debit, in line with UPI SI compliance. This should be sent at least 48 hours before triggering the actual recurring payment.

#### Sample Request

```json
curl -X POST "https://api-pacb.eximpe.com/partner-api/subscriptions/SUB_xxx/pre_debit_notification/" \
  -H "Content-Type: application/json" \
  -H "X-Client-ID: <your-client-id>" \
  -H "X-Client-Secret: <your-client-secret>" \
  -d '{
    "debit_date": "2025-06-10",
    "amount": 1000.00
  }'
```

#### Response

```json
{
  "success": true,
  "message": "Pre-debit notification triggered successfully",
  "data": {
    "subscription_id": "SUB_xxx",
    "debit_date": "2025-06-10",
    "amount": "1000.00",
    "notification_sent": true
  }
}
```

### 3.2 Trigger Recurring Payment

On the scheduled billing date, trigger the recurring payment using the **Trigger Recurring Payment** API.

#### Sample Request

```json
curl -X POST "https://api-pacb.eximpe.com/partner-api/subscriptions/SUB_xxx/recurring_payment/" \
  -H "Content-Type: application/json" \
  -H "X-Client-ID: <your-client-id>" \
  -H "X-Client-Secret: <your-client-secret>" \
  -d '{
    "amount": 1000.00
  }'
```

#### Response

```json
{
  "success": true,
  "message": "Recurring payment triggered successfully",
  "data": {
    "order_id": "ORD_xxx",
    "message": "UPI Collection request sent to somevpa@upi"
  }
}
```

Use the standard **Get Payment** or **Get Order** APIs or webhooks to track installment success and failures.

## Step 4: Modify or Cancel Mandate

EximPe can also send a server-to-server callback response whenever the subscription mandate status gets updated.

For more information, see the [Payment Successful response](https://docs.eximpe.com/api-reference/webhooks/payment-successful)



